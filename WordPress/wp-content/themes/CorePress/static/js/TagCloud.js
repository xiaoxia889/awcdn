(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?module.exports=t():typeof define==="function"&&define.amd?define(t):(e=e||self,e.TagCloud=t())})(this,function(){"use strict";function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}function e(e,t,n){if(t)i(e.prototype,t);if(n)i(e,n);return e}function a(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function s(){s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n){if(Object.prototype.hasOwnProperty.call(n,i)){e[i]=n[i]}}}return e};return s.apply(this,arguments)}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);if(e)i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable});n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};if(e%2){r(Object(n),true).forEach(function(e){a(t,e,n[e])})}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))}else{r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}}return t}var u=function(){function r(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:document.body;var t=arguments.length>1?arguments[1]:undefined;var n=arguments.length>2?arguments[2]:undefined;var i=arguments.length>3?arguments[3]:undefined;o(this,r);var a=this;if(!e||e.nodeType!==1)return new Error("Incorrect element type");a.$container=e;a.texts=t||[];a.clors=i||[];a.config=l(l({},r._defaultConfig),n||{});a.radius=a.config.radius;a.depth=2*a.radius;a.size=1.5*a.radius;a.maxSpeed=r._getMaxSpeed(a.config.maxSpeed);a.initSpeed=r._getInitSpeed(a.config.initSpeed);a.direction=a.config.direction;a.keep=a.config.keep;a.paused=false;a._createElment();a._init();r.list.push({el:a.$el,container:e,instance:a})}e(r,[{key:"_createElment",value:function e(){var i=this;var a=document.createElement("div");a.className=i.config.containerClass;if(i.config.useContainerInlineStyles){a.style.position="relative";a.style.height="".concat(2*i.radius,"px")}i.items=[];i.texts.forEach(function(e,t){var n=i._createTextItem(e,t);a.appendChild(n.el);i.items.push(n)});i.$container.appendChild(a);i.$el=a}},{key:"_createTextItem",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i=this;var a=document.createElement("span");a.className=i.config.itemClass;a.setAttribute("tag_id",n);var r=i.clors[Math.floor(Math.random()*i.clors.length)];if(i.config.useItemInlineStyles){a.style.willChange="transform, opacity, filter";a.style.position="absolute";a.style.top="50%";a.style.backgroundColor=r;a.style.left="50%";a.style.zIndex=n+1;a.style.filter="alpha(opacity=0)";a.style.opacity=0}a.innerHTML='<a href="'+t.href+'">'+t.text+"</a>";return l({el:a},i._computePosition(n))}},{key:"_computePosition",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var i=this;var a=i.texts.length;if(n)t=Math.floor(Math.random()*(a+1));var r=Math.acos(-1+(2*t+1)/a);var o=Math.sqrt((a+1)*Math.PI)*r;return{x:i.size*Math.cos(o)*Math.sin(r)/2,y:i.size*Math.sin(o)*Math.sin(r)/2,z:i.size*Math.cos(r)/2}}},{key:"_requestInterval",value:function e(n,i){var a=(function(){return window.requestAnimationFrame}||function(e,t){window.setTimeout(e,1e3/60)})();var r=(new Date).getTime();var o={};function s(){o.value=a(s);var e=(new Date).getTime(),t=e-r;if(t>=i){n.call();r=(new Date).getTime()}}o.value=a(s);return o}},{key:"_init",value:function e(){var n=this;n.active=false;n.mouseX0=n.initSpeed*Math.sin(n.direction*(Math.PI/180));n.mouseY0=-n.initSpeed*Math.cos(n.direction*(Math.PI/180));n.mouseX=n.mouseX0;n.mouseY=n.mouseY0;r._on(n.$el,"mouseover",function(){n.active=true});r._on(n.$el,"click",function(e){if(e.target.className==n.config.itemClass){console.log(e.target.getAttribute("tag_id"))}});r._on(n.$el,"mouseout",function(){n.active=false});r._on(n.keep?window:n.$el,"mousemove",function(e){e=e||window.event;var t=n.$el.getBoundingClientRect();n.mouseX=(e.clientX-(t.left+t.width/2))/5;n.mouseY=(e.clientY-(t.top+t.height/2))/5});n._next();n.interval=n._requestInterval(function(){n._next.call(n)},10)}},{key:"_next",value:function e(){var m=this;if(m.paused){return}if(!m.keep&&!m.active){m.mouseX=Math.abs(m.mouseX-m.mouseX0)<1?m.mouseX0:(m.mouseX+m.mouseX0)/2;m.mouseY=Math.abs(m.mouseY-m.mouseY0)<1?m.mouseY0:(m.mouseY+m.mouseY0)/2}var t=-(Math.min(Math.max(-m.mouseY,-m.size),m.size)/m.radius)*m.maxSpeed;var n=Math.min(Math.max(-m.mouseX,-m.size),m.size)/m.radius*m.maxSpeed;if(Math.abs(t)<=.01&&Math.abs(n)<=.01)return;var i=Math.PI/180;var v=[Math.sin(t*i),Math.cos(t*i),Math.sin(n*i),Math.cos(n*i)];m.items.forEach(function(e){var t=e.x;var n=e.y*v[1]+e.z*-v[0];var i=e.y*v[0]+e.z*v[1];var a=t*v[3]+i*v[2];var r=n;var o=i*v[3]-t*v[2];var s=2*m.depth/(2*m.depth+o);e.x=a;e.y=r;e.z=o;e.scale=s.toFixed(3);var l=s*s-.25;l=(l>1?1:l).toFixed(3);var u=e.el;var c=(e.x-u.offsetWidth/2).toFixed(2);var f=(e.y-u.offsetHeight/2).toFixed(2);var d="translate3d(".concat(c,"px, ").concat(f,"px, 0) scale(").concat(e.scale,")");u.style.WebkitTransform=d;u.style.MozTransform=d;u.style.OTransform=d;u.style.transform=d;u.style.filter="alpha(opacity=".concat(100*l,")");u.style.opacity=l})}},{key:"update",value:function e(t){var i=this;i.texts=t||[];i.texts.forEach(function(e,t){var n=i.items[t];if(!n){n=i._createTextItem(e,t);s(n,i._computePosition(t,true));i.$el.appendChild(n.el);i.items.push(n)}n.el.innerText=e});var n=i.texts.length;var a=i.items.length;if(n<a){var r=i.items.splice(n,a-n);r.forEach(function(e){i.$el.removeChild(e.el)})}}},{key:"destroy",value:function e(){var t=this;t.interval=null;var n=r.list.findIndex(function(e){return e.el===t.$el});if(n!==-1)r.list.splice(n,1);if(t.$container&&t.$el){t.$container.removeChild(t.$el)}}},{key:"pause",value:function e(){var t=this;t.paused=true}},{key:"resume",value:function e(){var t=this;t.paused=false}}],[{key:"_on",value:function e(t,n,i,a){if(t.addEventListener){t.addEventListener(n,i,a)}else if(t.attachEvent){t.attachEvent("on".concat(n),i)}else{t["on".concat(n)]=i}}}]);return r}();u.list=[];u._defaultConfig={radius:100,maxSpeed:"normal",initSpeed:"normal",direction:135,keep:true,useContainerInlineStyles:true,useItemInlineStyles:true,containerClass:"corepress-tagcloud",itemClass:"tagcloud--item"};u._getMaxSpeed=function(e){return{slow:.5,normal:1,fast:2}[e]||1};u._getInitSpeed=function(e){return{slow:16,normal:32,fast:80}[e]||32};var t=function(e,t,n,i){if(typeof e==="string")e=document.querySelectorAll(e);if(!e.forEach)e=[e];var a=[];e.forEach(function(e){if(e){a.push(new u(e,t,n,i))}});return a.length<=1?a[0]:a};return t});